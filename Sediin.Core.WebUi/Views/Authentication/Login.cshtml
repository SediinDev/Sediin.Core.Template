@model Sediin.Core.WebUi.Models.Authentication

@{
    ViewData["Title"] = "Login";

}

<h2>Login</h2>

<div id="loginResult"></div>

@using (Html.BeginAjaxForm("Login", "Authentication",
onBegin: "alertWaid()",
onSuccess: "onLoginSuccess",
onFailure: "handleError"))
{

                        @Html.TextBoxFor(model => model.Username,
                        new { @class = "form-control col-md-12", placeholder = "Codice utente", autocomplete = "off", type = "search" })
                    @Html.ValidationMessageFor(model => model.Username, "")
    </div>

    <div class="form-floating mb-3">
        <input asp-for="Password" class="form-control" autocomplete="current-password" aria-required="true" placeholder="password" type="password" />
        <label asp-for="Password">Password</label>
        <span asp-validation-for="Password" class="text-danger"></span>
    </div>

    <div class="form-check mb-3">
        <input class="form-check-input" asp-for="RememberMe" />
        <label class="form-check-label" asp-for="RememberMe">
            @Html.DisplayNameFor(m => m.RememberMe)
        </label>
    </div>

    <button type="submit" class="btn btn-primary w-100">Login</button>

}

<!-- Validazione -->
<partial name="_ValidationScriptsPartial" />

<script>
    function onLoginSuccess(response) {
        if (response.success) {
            $('#loginResult').html('<div class="alert alert-success">Accesso effettuato con successo!</div>');
            // Redirect se specificato
            if (response.redirectUrl) {
                setTimeout(function () {
                    window.location.href = response.redirectUrl;
                }, 1000);
            }
        } else {
            $('#loginResult').html('<div class="alert alert-danger">' + response.message + '</div>');
        }
    }

    function onLoginFailed(xhr) {
        $('#loginResult').html('<div class="alert alert-danger">Errore durante l’invio della richiesta.</div>');
    }
</script>
